
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.harvesterhci.io/v1.0/install/pxe-boot-install/">
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>PXE Boot Installation - Harvester - Open Source Hyperconverged Infrastructure</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../assets/swagger-ui/swagger-ui.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pxe-boot-installation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://harvesterhci.io" title="Harvester - Open Source Hyperconverged Infrastructure" class="md-header__button md-logo" aria-label="Harvester - Open Source Hyperconverged Infrastructure" data-md-component="logo">
      
  <img src="../../assets/logo_horizontal_white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Harvester - Open Source Hyperconverged Infrastructure
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PXE Boot Installation
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent=""  aria-label="Dark Mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Dark Mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3m0-4.5c5 0 9.27 3.11 11 7.5-1.73 4.39-6 7.5-11 7.5S2.73 16.39 1 12c1.73-4.39 6-7.5 11-7.5M3.18 12a9.821 9.821 0 0 0 17.64 0 9.821 9.821 0 0 0-17.64 0Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent=""  aria-label="Light Mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Light Mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/harvester/harvester" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    harvester/harvester
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://harvesterhci.io" title="Harvester - Open Source Hyperconverged Infrastructure" class="md-nav__button md-logo" aria-label="Harvester - Open Source Hyperconverged Infrastructure" data-md-component="logo">
      
  <img src="../../assets/logo_horizontal_white.png" alt="logo">

    </a>
    Harvester - Open Source Hyperconverged Infrastructure
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/harvester/harvester" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    harvester/harvester
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Harvester Overview
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Installation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Installation" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iso-install/" class="md-nav__link">
        ISO Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usb-install/" class="md-nav__link">
        USB Installation
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          PXE Boot Installation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        PXE Boot Installation
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisite" class="md-nav__link">
    Prerequisite
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-http-servers" class="md-nav__link">
    Preparing HTTP Servers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-boot-files" class="md-nav__link">
    Preparing Boot Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-ipxe-boot-scripts" class="md-nav__link">
    Preparing iPXE Boot Scripts
  </a>
  
    <nav class="md-nav" aria-label="Preparing iPXE Boot Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-mode" class="md-nav__link">
    CREATE Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#join-mode" class="md-nav__link">
    JOIN Mode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dhcp-server-configuration" class="md-nav__link">
    DHCP Server Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#harvester-configuration" class="md-nav__link">
    Harvester Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uefi-http-boot-support" class="md-nav__link">
    UEFI HTTP Boot support
  </a>
  
    <nav class="md-nav" aria-label="UEFI HTTP Boot support">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serve-the-ipxe-program" class="md-nav__link">
    Serve the iPXE Program
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhcp-server-configuration_1" class="md-nav__link">
    DHCP Server Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-ipxe-script-for-uefi-boot" class="md-nav__link">
    The iPXE Script for UEFI Boot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useful-kernel-parameters" class="md-nav__link">
    Useful Kernel Parameters
  </a>
  
    <nav class="md-nav" aria-label="Useful Kernel Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ipdhcp" class="md-nav__link">
    ip=dhcp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdnetdhcpretrycnt" class="md-nav__link">
    rd.net.dhcp.retry=&lt;cnt&gt;
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../harvester-configuration/" class="md-nav__link">
        Harvester Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../management-address/" class="md-nav__link">
        Management Address
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../airgap/" class="md-nav__link">
        Air Gapped Environment
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Upgrade
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Upgrade" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Upgrade
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/automatic/" class="md-nav__link">
        Upgrading Harvester
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/v1-0-1-to-v1-0-2/" class="md-nav__link">
        Upgrade from v1.0.1 to v1.0.2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/v1-0-0-to-v1-0-1/" class="md-nav__link">
        Upgrade from v1.0.0 to v1.0.1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../authentication/" class="md-nav__link">
        Authentication
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../upload-image/" class="md-nav__link">
        Upload Images
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../host/host/" class="md-nav__link">
        Host Management
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          VM Management
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="VM Management" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          VM Management
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../vm/create-vm/" class="md-nav__link">
        Create a Virtual Machine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../vm/create-windows-vm/" class="md-nav__link">
        Create a Windows Virtual Machine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../vm/edit-vm/" class="md-nav__link">
        Edit a Virtual Machine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../vm/access-to-the-vm/" class="md-nav__link">
        Access to the Virtual Machine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../vm/backup-restore/" class="md-nav__link">
        VM Backup & Restore
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../vm/live-migration/" class="md-nav__link">
        Live Migration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../vm/hotplug-volume/" class="md-nav__link">
        Hot-Plug Volumes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../vm/resource-overcommit/" class="md-nav__link">
        Resource Overcommit
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Networking
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Networking" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Networking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/harvester-network/" class="md-nav__link">
        Harvester Network
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_2" type="checkbox" id="__nav_9_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_2">
          Best Practice
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Best Practice" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_2">
          <span class="md-nav__icon md-icon"></span>
          Best Practice
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/best-practice/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/best-practice/multiple-nics-vlan-aware-switch/" class="md-nav__link">
        Mulitple NICs with VLAN-aware Switch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/best-practice/multiple-nics-non-vlan-aware-switch/" class="md-nav__link">
        Mulitple NICs with Non VLAN-aware Switch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/best-practice/single-nic-vlan-aware-switch/" class="md-nav__link">
        Single NIC with VLAN-aware Switch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/best-practice/single-nic-non-vlan-aware-switch/" class="md-nav__link">
        Single NIC with Non VLAN-aware Switch
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/monitoring/" class="md-nav__link">
        Monitoring
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          Rancher Integration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Rancher Integration" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Rancher Integration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rancher/rancher-integration/" class="md-nav__link">
        Rancher integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rancher/virtualization-management/" class="md-nav__link">
        Virtualization management
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11_3" type="checkbox" id="__nav_11_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11_3">
          Harvester Node Driver
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Harvester Node Driver" data-md-level="2">
        <label class="md-nav__title" for="__nav_11_3">
          <span class="md-nav__icon md-icon"></span>
          Harvester Node Driver
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rancher/node-driver/" class="md-nav__link">
        Harvester Node Driver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rancher/rke1-cluster/" class="md-nav__link">
        Creating an RKE1 Kubernetes Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rancher/rke2-cluster/" class="md-nav__link">
        Creating an RKE2 Kubernetes Cluster
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rancher/k3s-cluster/" class="md-nav__link">
        Creating an K3s Kubernetes Cluster
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rancher/cloud-provider/" class="md-nav__link">
        Harvester Cloud Provider
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../rancher/csi-driver/" class="md-nav__link">
        Harvester CSI Driver
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../terraform/terraform/" class="md-nav__link">
        Harvester Terraform Provider
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../settings/settings/" class="md-nav__link">
        Settings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../dev/dev-mode/" class="md-nav__link">
        Developer Mode Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_15" type="checkbox" id="__nav_15" >
      
      
      
      
        <label class="md-nav__link" for="__nav_15">
          Troubleshooting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Troubleshooting" data-md-level="1">
        <label class="md-nav__title" for="__nav_15">
          <span class="md-nav__icon md-icon"></span>
          Troubleshooting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/harvester/" class="md-nav__link">
        Harvester
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/os/" class="md-nav__link">
        Operating System
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/monitoring/" class="md-nav__link">
        Monitoring
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_16" type="checkbox" id="__nav_16" >
      
      
      
      
        <label class="md-nav__link" for="__nav_16">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_16">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/" class="md-nav__link">
        API Reference
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisite" class="md-nav__link">
    Prerequisite
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-http-servers" class="md-nav__link">
    Preparing HTTP Servers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-boot-files" class="md-nav__link">
    Preparing Boot Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-ipxe-boot-scripts" class="md-nav__link">
    Preparing iPXE Boot Scripts
  </a>
  
    <nav class="md-nav" aria-label="Preparing iPXE Boot Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-mode" class="md-nav__link">
    CREATE Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#join-mode" class="md-nav__link">
    JOIN Mode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dhcp-server-configuration" class="md-nav__link">
    DHCP Server Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#harvester-configuration" class="md-nav__link">
    Harvester Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uefi-http-boot-support" class="md-nav__link">
    UEFI HTTP Boot support
  </a>
  
    <nav class="md-nav" aria-label="UEFI HTTP Boot support">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#serve-the-ipxe-program" class="md-nav__link">
    Serve the iPXE Program
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhcp-server-configuration_1" class="md-nav__link">
    DHCP Server Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-ipxe-script-for-uefi-boot" class="md-nav__link">
    The iPXE Script for UEFI Boot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useful-kernel-parameters" class="md-nav__link">
    Useful Kernel Parameters
  </a>
  
    <nav class="md-nav" aria-label="Useful Kernel Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ipdhcp" class="md-nav__link">
    ip=dhcp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdnetdhcpretrycnt" class="md-nav__link">
    rd.net.dhcp.retry=&lt;cnt&gt;
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/harvester/docs/edit/main/docs/install/pxe-boot-install.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="pxe-boot-installation">PXE Boot Installation<a class="headerlink" href="#pxe-boot-installation" title="Permanent link">&para;</a></h1>
<p>Starting from version <code>0.2.0</code>, Harvester can be installed automatically. This document provides an example to do an automatic installation with PXE boot.</p>
<p>We recommend using <a href="https://ipxe.org/">iPXE</a> to perform the network boot. It has more features than the traditional PXE Boot program and is likely available in modern NIC cards. If the iPXE firmware is not available for your NIC card, the iPXE firmware images can be loaded from the TFTP server first.</p>
<p>To see sample iPXE scripts, please visit <a href="https://github.com/harvester/ipxe-examples">Harvester iPXE Examples</a>.</p>
<h2 id="prerequisite">Prerequisite<a class="headerlink" href="#prerequisite" title="Permanent link">&para;</a></h2>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Nodes need to have at least <strong>8G</strong> of RAM because the installer loads the full ISO file into tmpfs.</p>
</div>
<h2 id="preparing-http-servers">Preparing HTTP Servers<a class="headerlink" href="#preparing-http-servers" title="Permanent link">&para;</a></h2>
<p>An HTTP server is required to serve boot files.
Let's assume the NGINX HTTP server's IP is <code>10.100.0.10</code>, and it serves the <code>/usr/share/nginx/html/</code> directory with the path <code>http://10.100.0.10/</code>.</p>
<h2 id="preparing-boot-files">Preparing Boot Files<a class="headerlink" href="#preparing-boot-files" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Download the required files from the <a href="https://github.com/harvester/harvester/releases">Harvester releases page</a>.</p>
<ul>
<li>The ISO: <code>harvester-&lt;version&gt;-amd64.iso</code></li>
<li>The kernel: <code>harvester-&lt;version&gt;-vmlinuz-amd64</code></li>
<li>The initrd: <code>harvester-&lt;version&gt;-initrd-amd64</code></li>
<li>The rootfs squashfs image: <code>harvester-&lt;version&gt;-rootfs-amd64.squashfs</code></li>
</ul>
</li>
<li>
<p>Serve the files.</p>
<p>Copy or move the downloaded files to an appropriate location so they can be downloaded via the HTTP server. For example:</p>
<div class="highlight"><pre><span></span><code>sudo mkdir -p /usr/share/nginx/html/harvester/
sudo cp /path/to/harvester-&lt;version&gt;-amd64.iso /usr/share/nginx/html/harvester/
sudo cp /path/to/harvester-&lt;version&gt;-vmlinuz-amd64 /usr/share/nginx/html/harvester/
sudo cp /path/to/harvester-&lt;version&gt;-initrd-amd64 /usr/share/nginx/html/harvester/
sudo cp /path/to/harvester-&lt;version&gt;-rootfs-amd64.squashfs /usr/share/nginx/html/harvester/
</code></pre></div>
</li>
</ul>
<h2 id="preparing-ipxe-boot-scripts">Preparing iPXE Boot Scripts<a class="headerlink" href="#preparing-ipxe-boot-scripts" title="Permanent link">&para;</a></h2>
<p>When performing an automatic installation, there are two modes:</p>
<ul>
<li><code>CREATE</code>: we are installing a node to construct an initial Harvester cluster.</li>
<li><code>JOIN</code>: we are installing a node to join an existing Harvester cluster.</li>
</ul>
<h3 id="create-mode">CREATE Mode<a class="headerlink" href="#create-mode" title="Permanent link">&para;</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Security Risks</strong>: The configuration file below contains credentials which should be kept secret. Please do not make the configuration file publicly accessible.</p>
</div>
<p>Create a <a href="../harvester-configuration/">Harvester configuration file</a> called <code>config-create.yaml</code> for <code>CREATE</code> mode. Modify the values as needed:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># cat /usr/share/nginx/html/harvester/config-create.yaml</span><span class="w"></span>
<span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">token</span><span class="w"></span>
<span class="nt">os</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">node1</span><span class="w"></span>
<span class="w">  </span><span class="nt">ssh_authorized_keys</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDbeUa9A7Kee+hcCleIXYxuaPksn2m4PZTd4T7wPcse8KbsQfttGRax6vxQXoPO6ehddqOb2nV7tkW2mEhR50OE7W7ngDHbzK2OneAyONYF44bmMsapNAGvnsBKe9rNrev1iVBwOjtmyVLhnLrJIX+2+3T3yauxdu+pmBsnD5OIKUrBrN1sdwW0rA2rHDiSnzXHNQM3m02aY6mlagdQ/Ovh96h05QFCHYxBc6oE/mIeFRaNifa4GU/oELn3a6HfbETeBQz+XOEN+IrLpnZO9riGyzsZroB/Y3Ju+cJxH06U0B7xwJCRmWZjuvfFQUP7RIJD1gRGZzmf3h8+F+oidkO2i5rbT57NaYSqkdVvR6RidVLWEzURZIGbtHjSPCi4kqD05ua8r/7CC0PvxQb1O5ILEdyJr2ZmzhF6VjjgmyrmSmt/yRq8MQtGQxyKXZhJqlPYho4d5SrHi5iGT2PvgDQaWch0I3ndEicaaPDZJHWBxVsCVAe44Wtj9g3LzXkyu3k= root@admin</span><span class="w"></span>
<span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rancher</span><span class="w"></span>
<span class="w">  </span><span class="nt">ntp_servers</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.suse.pool.ntp.org</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.suse.pool.ntp.org</span><span class="w"></span>
<span class="nt">install</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">create</span><span class="w"></span>
<span class="w">  </span><span class="nt">networks</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">harvester-mgmt</span><span class="p">:</span><span class="w">       </span><span class="c1"># (Mandatory) The management bond name.</span><span class="w"></span>
<span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ens5</span><span class="w"></span>
<span class="w">      </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dhcp</span><span class="w"></span>
<span class="w">      </span><span class="nt">bond_options</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">balance-tlb</span><span class="w"></span>
<span class="w">        </span><span class="nt">miimon</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span><span class="w"></span>
<span class="w">    </span><span class="nt">harvester-vlan</span><span class="p">:</span><span class="w">       </span><span class="c1"># (Optional) The VLAN network bond name. If VLAN NIC names vary from</span><span class="w"></span>
<span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w">         </span><span class="c1"># host to host, consider creating a bonding device. Users can then select</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ens6</span><span class="w">        </span><span class="c1"># `harvester-vlan` as the VLAN network NIC in the Harvester GUI.</span><span class="w"></span>
<span class="w">      </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">none</span><span class="w"></span>
<span class="w">      </span><span class="nt">bond_options</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">balance-tlb</span><span class="w"></span>
<span class="w">        </span><span class="nt">miimon</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span><span class="w"></span>
<span class="w">  </span><span class="nt">device</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/dev/sda</span><span class="w"></span>
<span class="w">  </span><span class="nt">iso_url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://10.100.0.10/harvester/harvester-&lt;version&gt;-amd64.iso</span><span class="w"></span>
<span class="w">  </span><span class="nt">vip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.100.0.99</span><span class="w">        </span><span class="c1"># The VIP to access the Harvester GUI. Make sure the IP is free to use.</span><span class="w"></span>
<span class="w">  </span><span class="nt">vip_mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">static</span><span class="w">        </span><span class="c1"># Or dhcp, check configuration file for more information.</span><span class="w"></span>
</code></pre></div>
<p>For machines that needs to be installed using <code>CREATE</code> mode, the following is an iPXE script that boots the kernel with the above config:</p>
<div class="highlight"><pre><span></span><code>#!ipxe
kernel harvester-&lt;version&gt;-vmlinuz ip=dhcp net.ifnames=1 rd.cos.disable rd.noverifyssl console=tty1 root=live:http://10.100.0.10/harvester/rootfs.squashfs harvester.install.automatic=true harvester.install.config_url=http://10.100.0.10/harvester/config-create.yaml
initrd harvester-&lt;version&gt;-initrd
boot
</code></pre></div>
<p>This assumes the iPXE script is stored in <code>/usr/share/nginx/html/harvester/ipxe-create</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have multiple network interfaces,
you can leverage dracut's <code>ip=</code> parameter to specify the booting interface
and any other network configurations that dracut supports (e.g., <code>ip=eth1:dhcp</code>)
See <a href="https://man7.org/linux/man-pages/man7/dracut.cmdline.7.html"><code>man dracut.cmdline</code></a> for more information.</p>
<p>Use <code>ip=</code> parameter to designate the booting interface only, as we only support <strong>one single <code>ip=</code> parameter</strong>.</p>
</div>
<h3 id="join-mode">JOIN Mode<a class="headerlink" href="#join-mode" title="Permanent link">&para;</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Security Risks</strong>: The configuration file below contains credentials which should be kept secret. Please do not make the configuration file publicly accessible.</p>
</div>
<p>Create a <a href="../harvester-configuration/">Harvester configuration file</a> called <code>config-join.yaml</code> for <code>JOIN</code> mode. Modify the values as needed:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># cat /usr/share/nginx/html/harvester/config-join.yaml</span><span class="w"></span>
<span class="nt">server_url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://10.100.0.99:443</span><span class="w">  </span><span class="c1"># Should be the VIP set up in &quot;CREATE&quot; config</span><span class="w"></span>
<span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">token</span><span class="w"></span>
<span class="nt">os</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">node2</span><span class="w"></span>
<span class="w">  </span><span class="nt">ssh_authorized_keys</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDbeUa9A7Kee+hcCleIXYxuaPksn2m4PZTd4T7wPcse8KbsQfttGRax6vxQXoPO6ehddqOb2nV7tkW2mEhR50OE7W7ngDHbzK2OneAyONYF44bmMsapNAGvnsBKe9rNrev1iVBwOjtmyVLhnLrJIX+2+3T3yauxdu+pmBsnD5OIKUrBrN1sdwW0rA2rHDiSnzXHNQM3m02aY6mlagdQ/Ovh96h05QFCHYxBc6oE/mIeFRaNifa4GU/oELn3a6HfbETeBQz+XOEN+IrLpnZO9riGyzsZroB/Y3Ju+cJxH06U0B7xwJCRmWZjuvfFQUP7RIJD1gRGZzmf3h8+F+oidkO2i5rbT57NaYSqkdVvR6RidVLWEzURZIGbtHjSPCi4kqD05ua8r/7CC0PvxQb1O5ILEdyJr2ZmzhF6VjjgmyrmSmt/yRq8MQtGQxyKXZhJqlPYho4d5SrHi5iGT2PvgDQaWch0I3ndEicaaPDZJHWBxVsCVAe44Wtj9g3LzXkyu3k= root@admin</span><span class="w"></span>
<span class="w">  </span><span class="nt">dns_nameservers</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.1.1.1</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8.8.8.8</span><span class="w"></span>
<span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rancher</span><span class="w"></span>
<span class="nt">install</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">join</span><span class="w"></span>
<span class="w">  </span><span class="nt">networks</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">harvester-mgmt</span><span class="p">:</span><span class="w">       </span><span class="c1"># (Mandatory) The management bond name.</span><span class="w"></span>
<span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ens5</span><span class="w"></span>
<span class="w">      </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dhcp</span><span class="w"></span>
<span class="w">      </span><span class="nt">bond_options</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">balance-tlb</span><span class="w"></span>
<span class="w">        </span><span class="nt">miimon</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w"></span>
<span class="w">    </span><span class="nt">harvester-vlan</span><span class="p">:</span><span class="w">       </span><span class="c1"># (Optional) The VLAN network bond name. If VLAN NIC names vary from</span><span class="w"></span>
<span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w">         </span><span class="c1"># host to host, consider creating a bonding device. Users can then select</span><span class="w"></span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ens6</span><span class="w">        </span><span class="c1"># `harvester-vlan` as the VLAN network NIC in the Harvester GUI.</span><span class="w"></span>
<span class="w">      </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">none</span><span class="w"></span>
<span class="w">      </span><span class="nt">bond_options</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">balance-tlb</span><span class="w"></span>
<span class="w">        </span><span class="nt">miimon</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span><span class="w"></span>
<span class="w">  </span><span class="nt">device</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/dev/sda</span><span class="w"></span>
<span class="w">  </span><span class="nt">iso_url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://10.100.0.10/harvester/harvester-&lt;version&gt;-amd64.iso</span><span class="w"></span>
</code></pre></div>
<p>Note that the <code>mode</code> is <code>join</code> and the <code>server_url</code> needs to be provided.</p>
<p>For machines that needs to be installed in <code>JOIN</code> mode, the following is an iPXE script that boots the kernel with the above config:</p>
<div class="highlight"><pre><span></span><code>#!ipxe
kernel harvester-&lt;version&gt;-vmlinuz ip=dhcp net.ifnames=1 rd.cos.disable rd.noverifyssl console=tty1 root=live:http://10.100.0.10/harvester/rootfs.squashfs harvester.install.automatic=true harvester.install.config_url=http://10.100.0.10/harvester/config-join.yaml
initrd harvester-&lt;version&gt;-initrd
boot
</code></pre></div>
<p>This assumes the iPXE script is stored in <code>/usr/share/nginx/html/harvester/ipxe-join</code>.</p>
<h2 id="dhcp-server-configuration">DHCP Server Configuration<a class="headerlink" href="#dhcp-server-configuration" title="Permanent link">&para;</a></h2>
<p>The following is an example of how to configure the ISC DHCP server to offer iPXE scripts:</p>
<div class="highlight"><pre><span></span><code>option architecture-type code <span class="nv">93</span> <span class="o">=</span> unsigned integer <span class="m">16</span><span class="p">;</span>

subnet <span class="m">10</span>.100.0.0 netmask <span class="m">255</span>.255.255.0 <span class="o">{</span>
    option routers <span class="m">10</span>.100.0.10<span class="p">;</span>
        option domain-name-servers <span class="m">192</span>.168.2.1<span class="p">;</span>
    range <span class="m">10</span>.100.0.100 <span class="m">10</span>.100.0.253<span class="p">;</span>
<span class="o">}</span>

group <span class="o">{</span>
  <span class="c1"># create group</span>
  <span class="k">if</span> exists user-class and option user-class <span class="o">=</span> <span class="s2">&quot;iPXE&quot;</span> <span class="o">{</span>
    <span class="c1"># iPXE Boot</span>
    <span class="k">if</span> option architecture-type <span class="o">=</span> <span class="m">00</span>:07 <span class="o">{</span>
      filename <span class="s2">&quot;http://10.100.0.10/harvester/ipxe-create-efi&quot;</span><span class="p">;</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      filename <span class="s2">&quot;http://10.100.0.10/harvester/ipxe-create&quot;</span><span class="p">;</span>
    <span class="o">}</span>
  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="c1"># PXE Boot</span>
    <span class="k">if</span> option architecture-type <span class="o">=</span> <span class="m">00</span>:07 <span class="o">{</span>
      <span class="c1"># UEFI</span>
      filename <span class="s2">&quot;ipxe.efi&quot;</span><span class="p">;</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="c1"># Non-UEFI</span>
      filename <span class="s2">&quot;undionly.kpxe&quot;</span><span class="p">;</span>
    <span class="o">}</span>
  <span class="o">}</span>

  host node1 <span class="o">{</span> hardware ethernet <span class="m">52</span>:54:00:6b:13:e2<span class="p">;</span> <span class="o">}</span>
<span class="o">}</span>


group <span class="o">{</span>
  <span class="c1"># join group</span>
  <span class="k">if</span> exists user-class and option user-class <span class="o">=</span> <span class="s2">&quot;iPXE&quot;</span> <span class="o">{</span>
    <span class="c1"># iPXE Boot</span>
    <span class="k">if</span> option architecture-type <span class="o">=</span> <span class="m">00</span>:07 <span class="o">{</span>
      filename <span class="s2">&quot;http://10.100.0.10/harvester/ipxe-join-efi&quot;</span><span class="p">;</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      filename <span class="s2">&quot;http://10.100.0.10/harvester/ipxe-join&quot;</span><span class="p">;</span>
    <span class="o">}</span>
  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="c1"># PXE Boot</span>
    <span class="k">if</span> option architecture-type <span class="o">=</span> <span class="m">00</span>:07 <span class="o">{</span>
      <span class="c1"># UEFI</span>
      filename <span class="s2">&quot;ipxe.efi&quot;</span><span class="p">;</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="c1"># Non-UEFI</span>
      filename <span class="s2">&quot;undionly.kpxe&quot;</span><span class="p">;</span>
    <span class="o">}</span>
  <span class="o">}</span>

  host node2 <span class="o">{</span> hardware ethernet <span class="m">52</span>:54:00:69:d5:92<span class="p">;</span> <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>The config file declares a subnet and two groups. The first group is for hosts to boot using <code>CREATE</code> mode and the other one is for <code>JOIN</code> mode. By default, the iPXE path is chosen, but if it sees a PXE client it offers the iPXE image according to the client architecture. Please prepare those images and a TFTP server first.</p>
<h2 id="harvester-configuration">Harvester Configuration<a class="headerlink" href="#harvester-configuration" title="Permanent link">&para;</a></h2>
<p>For more information about Harvester configuration, please refer to the <a href="../harvester-configuration/">Harvester configuration</a> page.</p>
<p>Users can also provide configuration via kernel parameters. For example, to specify the <code>CREATE</code> install mode, users can pass the <code>harvester.install.mode=create</code> kernel parameter when booting. Values passed through kernel parameters have higher priority than values specified in the config file.</p>
<h2 id="uefi-http-boot-support">UEFI HTTP Boot support<a class="headerlink" href="#uefi-http-boot-support" title="Permanent link">&para;</a></h2>
<p>UEFI firmware supports loading a boot image from an HTTP server. This section demonstrates how to use UEFI HTTP boot to load the iPXE program and perform an automatic installation.</p>
<h3 id="serve-the-ipxe-program">Serve the iPXE Program<a class="headerlink" href="#serve-the-ipxe-program" title="Permanent link">&para;</a></h3>
<p>Download the iPXE UEFI program from http://boot.ipxe.org/ipxe.efi and make sure <code>ipxe.efi</code> can be downloaded from the HTTP server. For example:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> /usr/share/nginx/html/harvester/
wget http://boot.ipxe.org/ipxe.efi
</code></pre></div>
<p>The file now can be downloaded from http://10.100.0.10/harvester/ipxe.efi locally.</p>
<h3 id="dhcp-server-configuration_1">DHCP Server Configuration<a class="headerlink" href="#dhcp-server-configuration_1" title="Permanent link">&para;</a></h3>
<p>If the user plans to use the UEFI HTTP boot feature by getting a dynamic IP first, the DHCP server needs to provide the iPXE program URL when it sees such a request. The following is an updated ISC DHCP server group example:</p>
<div class="highlight"><pre><span></span><code>group <span class="o">{</span>
  <span class="c1"># create group</span>
  <span class="k">if</span> exists user-class and option user-class <span class="o">=</span> <span class="s2">&quot;iPXE&quot;</span> <span class="o">{</span>
    <span class="c1"># iPXE Boot</span>
    <span class="k">if</span> option architecture-type <span class="o">=</span> <span class="m">00</span>:07 <span class="o">{</span>
      filename <span class="s2">&quot;http://10.100.0.10/harvester/ipxe-create-efi&quot;</span><span class="p">;</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      filename <span class="s2">&quot;http://10.100.0.10/harvester/ipxe-create&quot;</span><span class="p">;</span>
    <span class="o">}</span>
  <span class="o">}</span> elsif substring <span class="o">(</span>option vendor-class-identifier, <span class="m">0</span>, <span class="m">10</span><span class="o">)</span> <span class="o">=</span> <span class="s2">&quot;HTTPClient&quot;</span> <span class="o">{</span>
    <span class="c1"># UEFI HTTP Boot</span>
    option vendor-class-identifier <span class="s2">&quot;HTTPClient&quot;</span><span class="p">;</span>
    filename <span class="s2">&quot;http://10.100.0.10/harvester/ipxe.efi&quot;</span><span class="p">;</span>
  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="c1"># PXE Boot</span>
    <span class="k">if</span> option architecture-type <span class="o">=</span> <span class="m">00</span>:07 <span class="o">{</span>
      <span class="c1"># UEFI</span>
      filename <span class="s2">&quot;ipxe.efi&quot;</span><span class="p">;</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="c1"># Non-UEFI</span>
      filename <span class="s2">&quot;undionly.kpxe&quot;</span><span class="p">;</span>
    <span class="o">}</span>
  <span class="o">}</span>

  host node1 <span class="o">{</span> hardware ethernet <span class="m">52</span>:54:00:6b:13:e2<span class="p">;</span> <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>The <code>elsif substring</code> statement is new, and it offers <code>http://10.100.0.10/harvester/ipxe.efi</code> when it sees a UEFI HTTP boot DHCP request. After the client fetches the iPXE program and runs it, the iPXE program will send a DHCP request again and load the iPXE script from the URL <code>http://10.100.0.10/harvester/ipxe-create-efi</code>.</p>
<h3 id="the-ipxe-script-for-uefi-boot">The iPXE Script for UEFI Boot<a class="headerlink" href="#the-ipxe-script-for-uefi-boot" title="Permanent link">&para;</a></h3>
<p>It's mandatory to specify the initrd image for UEFI boot in the kernel parameters. The following is an updated version of iPXE script for <code>CREATE</code> mode.</p>
<div class="highlight"><pre><span></span><code>#!ipxe
kernel harvester-&lt;version&gt;-vmlinuz initrd=harvester-&lt;version&gt;-initrd ip=dhcp net.ifnames=1 rd.cos.disable rd.noverifyssl console=tty1 root=live:http://10.100.0.10/harvester/rootfs.squashfs harvester.install.automatic=true harvester.install.config_url=http://10.100.0.10/harvester/config-create.yaml
initrd harvester-&lt;version&gt;-initrd
boot
</code></pre></div>
<p>The parameter <code>initrd=harvester-&lt;version&gt;-initrd</code> is required.</p>
<h2 id="useful-kernel-parameters">Useful Kernel Parameters<a class="headerlink" href="#useful-kernel-parameters" title="Permanent link">&para;</a></h2>
<p>Besides the Harvester configuration, you can also specify other kernel parameters that are useful in different scenarios.
See also <a href="https://man7.org/linux/man-pages/man7/dracut.cmdline.7.html">dracut.cmdline(7)</a>.</p>
<h3 id="ipdhcp"><code>ip=dhcp</code><a class="headerlink" href="#ipdhcp" title="Permanent link">&para;</a></h3>
<p>If you have multiple network interfaces, you could add the <code>ip=dhcp</code> parameter to get IP from the DHCP server from all interfaces.</p>
<h3 id="rdnetdhcpretrycnt"><code>rd.net.dhcp.retry=&lt;cnt&gt;</code><a class="headerlink" href="#rdnetdhcpretrycnt" title="Permanent link">&para;</a></h3>
<p>Failing to get IP from the DHCP server would cause iPXE booting to fail. You can add parameter <code>rd.net.dhcp.retry=&lt;cnt&gt;</code>
to retry DHCP request for <code>&lt;cnt&gt;</code> times.</p>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../usb-install/" class="md-footer__link md-footer__link--prev" aria-label="Previous: USB Installation" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              USB Installation
            </div>
          </div>
        </a>
      
      
        
        <a href="../harvester-configuration/" class="md-footer__link md-footer__link--next" aria-label="Next: Harvester Configuration" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Harvester Configuration
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="../../assets/swagger-ui/swagger-ui-bundle.js"></script>
      
    
  </body>
</html>