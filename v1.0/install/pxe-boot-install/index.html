<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-v1.0 plugin-docs plugin-id-default docs-doc-id-install/pxe-boot-install">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">PXE Boot Installation | Harvester</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.harvesterhci.io/v1.0/install/pxe-boot-install"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v1.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v1.0"><meta data-rh="true" name="docsearch:version" content="v1.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v1.0"><meta data-rh="true" property="og:title" content="PXE Boot Installation | Harvester"><meta data-rh="true" name="description" content="Starting from version 0.2.0, Harvester can be installed automatically. This document provides an example to do an automatic installation with PXE boot."><meta data-rh="true" property="og:description" content="Starting from version 0.2.0, Harvester can be installed automatically. This document provides an example to do an automatic installation with PXE boot."><meta data-rh="true" name="keywords" content="Harvester,harvester,Rancher,rancher,Install Harvester,Installing Harvester,Harvester Installation,PXE Boot Install"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.harvesterhci.io/v1.0/install/pxe-boot-install"><link data-rh="true" rel="alternate" href="https://docs.harvesterhci.io/v1.0/install/pxe-boot-install" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.harvesterhci.io/zh/v1.0/install/pxe-boot-install" hreflang="zh"><link data-rh="true" rel="alternate" href="https://docs.harvesterhci.io/v1.0/install/pxe-boot-install" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://U7QCSJFCWR-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-57KS2MW",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>


<link rel="search" type="application/opensearchdescription+xml" title="Harvester" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.831dbdae.css">
<link rel="preload" href="/assets/js/runtime~main.693e3b15.js" as="script">
<link rel="preload" href="/assets/js/main.d1ef793e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-57KS2MW" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo_horizontal.svg" alt="Harvester Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_horizontal.svg" alt="Harvester Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/v1.0/">v1.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/dev/install/pxe-boot-install">v1.2-dev</a></li><li><a class="dropdown__link" href="/v1.1/install/pxe-boot-install">v1.1</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/v1.0/install/pxe-boot-install">v1.0</a></li><li><a class="dropdown__link" href="/v0.3/install/pxe-boot-install">v0.3</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/v1.0/install/pxe-boot-install" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh/v1.0/install/pxe-boot-install" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">简体中文</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__docs navbar__link--active" href="/v1.0/">Docs</a><a href="https://www.suse.com/c/?s=harvester" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__blog">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://harvesterhci.io/kb" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__kb">Knowledge Base<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/harvester/harvester" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__github btn btn-secondary icon-github">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v1.0/">Harvester Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/v1.0/install/requirements">Installation</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/v1.0/install/requirements">Requirements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/v1.0/install/iso-install">ISO Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/v1.0/install/usb-install">USB Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/v1.0/install/pxe-boot-install">PXE Boot Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/v1.0/install/harvester-configuration">Harvester Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/v1.0/install/management-address">Management Address</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v1.0/airgap">Air Gapped Environment</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/v1.0/upgrade/automatic">Upgrade</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v1.0/authentication">Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v1.0/upload-image">Upload Images</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v1.0/host/">Host Management</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/v1.0/vm/create-vm">VM Management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/v1.0/networking/harvester-network">Networking</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v1.0/monitoring/">Monitoring</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/v1.0/rancher/rancher-integration">Rancher Integration</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v1.0/terraform/">Harvester Terraform Provider</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v1.0/settings/">Settings</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/v1.0/troubleshooting/installation">Troubleshooting</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v1.0/faq">FAQ</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div><div><b>Harvester</b> <b>v1.0</b> is EOL and this documentation is no longer actively maintained. For more details, refer to the <a href="https://www.suse.com/suse-harvester/support-matrix/all-supported-versions/"><b>SUSE support matrix</b></a>.</div></div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/v1.1/install/pxe-boot-install">latest version</a></b> (<!-- -->v1.1<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Installation</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">PXE Boot Installation</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v1.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>PXE Boot Installation</h1></header><p>Starting from version <code>0.2.0</code>, Harvester can be installed automatically. This document provides an example to do an automatic installation with PXE boot.</p><p>We recommend using <a href="https://ipxe.org/" target="_blank" rel="noopener noreferrer">iPXE</a> to perform the network boot. It has more features than the traditional PXE Boot program and is likely available in modern NIC cards. If the iPXE firmware is not available for your NIC card, the iPXE firmware images can be loaded from the TFTP server first.</p><p>To see sample iPXE scripts, please visit <a href="https://github.com/harvester/ipxe-examples/tree/v1.0" target="_blank" rel="noopener noreferrer">Harvester iPXE Examples</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisite">Prerequisite<a href="#prerequisite" class="hash-link" aria-label="Direct link to Prerequisite" title="Direct link to Prerequisite">​</a></h2><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Nodes need to have at least <strong>8G</strong> of RAM because the installer loads the full ISO file into tmpfs.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="preparing-http-servers">Preparing HTTP Servers<a href="#preparing-http-servers" class="hash-link" aria-label="Direct link to Preparing HTTP Servers" title="Direct link to Preparing HTTP Servers">​</a></h2><p>An HTTP server is required to serve boot files.
Let&#x27;s assume the NGINX HTTP server&#x27;s IP is <code>10.100.0.10</code>, and it serves the <code>/usr/share/nginx/html/</code> directory with the path <code>http://10.100.0.10/</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="preparing-boot-files">Preparing Boot Files<a href="#preparing-boot-files" class="hash-link" aria-label="Direct link to Preparing Boot Files" title="Direct link to Preparing Boot Files">​</a></h2><ul><li><p>Download the required files from the <a href="https://github.com/harvester/harvester/releases" target="_blank" rel="noopener noreferrer">Harvester releases page</a>.</p><ul><li>The ISO: <code>harvester-&lt;version&gt;-amd64.iso</code></li><li>The kernel: <code>harvester-&lt;version&gt;-vmlinuz-amd64</code></li><li>The initrd: <code>harvester-&lt;version&gt;-initrd-amd64</code></li><li>The rootfs squashfs image: <code>harvester-&lt;version&gt;-rootfs-amd64.squashfs</code></li></ul></li><li><p>Serve the files.</p><p>  Copy or move the downloaded files to an appropriate location so they can be downloaded via the HTTP server. For example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo mkdir -p /usr/share/nginx/html/harvester/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp /path/to/harvester-&lt;version&gt;-amd64.iso /usr/share/nginx/html/harvester/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp /path/to/harvester-&lt;version&gt;-vmlinuz-amd64 /usr/share/nginx/html/harvester/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp /path/to/harvester-&lt;version&gt;-initrd-amd64 /usr/share/nginx/html/harvester/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp /path/to/harvester-&lt;version&gt;-rootfs-amd64.squashfs /usr/share/nginx/html/harvester/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="preparing-ipxe-boot-scripts">Preparing iPXE Boot Scripts<a href="#preparing-ipxe-boot-scripts" class="hash-link" aria-label="Direct link to Preparing iPXE Boot Scripts" title="Direct link to Preparing iPXE Boot Scripts">​</a></h2><p>When performing an automatic installation, there are two modes:</p><ul><li><code>CREATE</code>: we are installing a node to construct an initial Harvester cluster.</li><li><code>JOIN</code>: we are installing a node to join an existing Harvester cluster.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-mode">CREATE Mode<a href="#create-mode" class="hash-link" aria-label="Direct link to CREATE Mode" title="Direct link to CREATE Mode">​</a></h3><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p><strong>Security Risks</strong>: The configuration file below contains credentials which should be kept secret. Please do not make the configuration file publicly accessible.</p></div></div><p>Create a <a href="/v1.0/install/harvester-configuration">Harvester configuration file</a> called <code>config-create.yaml</code> for <code>CREATE</code> mode. Modify the values as needed:</p><div class="language-YAML codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-YAML codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># cat /usr/share/nginx/html/harvester/config-create.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">token: token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">os:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hostname: node1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ssh_authorized_keys:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDbeUa9A7Kee+hcCleIXYxuaPksn2m4PZTd4T7wPcse8KbsQfttGRax6vxQXoPO6ehddqOb2nV7tkW2mEhR50OE7W7ngDHbzK2OneAyONYF44bmMsapNAGvnsBKe9rNrev1iVBwOjtmyVLhnLrJIX+2+3T3yauxdu+pmBsnD5OIKUrBrN1sdwW0rA2rHDiSnzXHNQM3m02aY6mlagdQ/Ovh96h05QFCHYxBc6oE/mIeFRaNifa4GU/oELn3a6HfbETeBQz+XOEN+IrLpnZO9riGyzsZroB/Y3Ju+cJxH06U0B7xwJCRmWZjuvfFQUP7RIJD1gRGZzmf3h8+F+oidkO2i5rbT57NaYSqkdVvR6RidVLWEzURZIGbtHjSPCi4kqD05ua8r/7CC0PvxQb1O5ILEdyJr2ZmzhF6VjjgmyrmSmt/yRq8MQtGQxyKXZhJqlPYho4d5SrHi5iGT2PvgDQaWch0I3ndEicaaPDZJHWBxVsCVAe44Wtj9g3LzXkyu3k= root@admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  password: rancher</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ntp_servers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 0.suse.pool.ntp.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 1.suse.pool.ntp.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">install:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mode: create</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    harvester-mgmt:       # (Mandatory) The management bond name.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      interfaces:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: ens5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: dhcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      bond_options:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mode: balance-tlb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        miimon: 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    harvester-vlan:       # (Optional) The VLAN network bond name. If VLAN NIC names vary from</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      interfaces:         # host to host, consider creating a bonding device. Users can then select</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: ens6        # `harvester-vlan` as the VLAN network NIC in the Harvester GUI.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      bond_options:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mode: balance-tlb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        miimon: 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  device: /dev/sda</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  iso_url: http://10.100.0.10/harvester/harvester-&lt;version&gt;-amd64.iso</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  vip: 10.100.0.99        # The VIP to access the Harvester GUI. Make sure the IP is free to use.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  vip_mode: static        # Or dhcp, check configuration file for more information.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For machines that needs to be installed using <code>CREATE</code> mode, the following is an iPXE script that boots the kernel with the above config:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!ipxe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernel harvester-&lt;version&gt;-vmlinuz ip=dhcp net.ifnames=1 rd.cos.disable rd.noverifyssl console=tty1 root=live:http://10.100.0.10/harvester/rootfs.squashfs harvester.install.automatic=true harvester.install.config_url=http://10.100.0.10/harvester/config-create.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">initrd harvester-&lt;version&gt;-initrd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This assumes the iPXE script is stored in <code>/usr/share/nginx/html/harvester/ipxe-create</code>.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>If you have multiple network interfaces, you can leverage dracut&#x27;s <code>ip=</code> parameter to specify the booting interface and any other network configurations that dracut supports (e.g., <code>ip=eth1:dhcp</code>).
See <a href="https://man7.org/linux/man-pages/man7/dracut.cmdline.7.html" target="_blank" rel="noopener noreferrer"><code>man dracut.cmdline</code></a> for more information.</p><p>Use <code>ip=</code> parameter to designate the booting interface only, as we only support <strong>one single <code>ip=</code> parameter</strong>.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="join-mode">JOIN Mode<a href="#join-mode" class="hash-link" aria-label="Direct link to JOIN Mode" title="Direct link to JOIN Mode">​</a></h3><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p><strong>Security Risks</strong>: The configuration file below contains credentials which should be kept secret. Please do not make the configuration file publicly accessible.</p></div></div><p>Create a <a href="/v1.0/install/harvester-configuration">Harvester configuration file</a> called <code>config-join.yaml</code> for <code>JOIN</code> mode. Modify the values as needed:</p><div class="language-YAML codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-YAML codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># cat /usr/share/nginx/html/harvester/config-join.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server_url: https://10.100.0.99:443  # Should be the VIP set up in &quot;CREATE&quot; config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">token: token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">os:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hostname: node2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ssh_authorized_keys:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDbeUa9A7Kee+hcCleIXYxuaPksn2m4PZTd4T7wPcse8KbsQfttGRax6vxQXoPO6ehddqOb2nV7tkW2mEhR50OE7W7ngDHbzK2OneAyONYF44bmMsapNAGvnsBKe9rNrev1iVBwOjtmyVLhnLrJIX+2+3T3yauxdu+pmBsnD5OIKUrBrN1sdwW0rA2rHDiSnzXHNQM3m02aY6mlagdQ/Ovh96h05QFCHYxBc6oE/mIeFRaNifa4GU/oELn3a6HfbETeBQz+XOEN+IrLpnZO9riGyzsZroB/Y3Ju+cJxH06U0B7xwJCRmWZjuvfFQUP7RIJD1gRGZzmf3h8+F+oidkO2i5rbT57NaYSqkdVvR6RidVLWEzURZIGbtHjSPCi4kqD05ua8r/7CC0PvxQb1O5ILEdyJr2ZmzhF6VjjgmyrmSmt/yRq8MQtGQxyKXZhJqlPYho4d5SrHi5iGT2PvgDQaWch0I3ndEicaaPDZJHWBxVsCVAe44Wtj9g3LzXkyu3k= root@admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dns_nameservers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 1.1.1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - 8.8.8.8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  password: rancher</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">install:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mode: join</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  networks:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    harvester-mgmt:       # (Mandatory) The management bond name.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      interfaces:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: ens5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: dhcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      bond_options:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mode: balance-tlb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        miimon: 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    harvester-vlan:       # (Optional) The VLAN network bond name. If VLAN NIC names vary from</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      interfaces:         # host to host, consider creating a bonding device. Users can then select</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: ens6        # `harvester-vlan` as the VLAN network NIC in the Harvester GUI.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      method: none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      bond_options:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mode: balance-tlb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        miimon: 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  device: /dev/sda</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  iso_url: http://10.100.0.10/harvester/harvester-&lt;version&gt;-amd64.iso</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that the <code>mode</code> is <code>join</code> and the <code>server_url</code> needs to be provided.</p><p>For machines that needs to be installed in <code>JOIN</code> mode, the following is an iPXE script that boots the kernel with the above config:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!ipxe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernel harvester-&lt;version&gt;-vmlinuz ip=dhcp net.ifnames=1 rd.cos.disable rd.noverifyssl console=tty1 root=live:http://10.100.0.10/harvester/rootfs.squashfs harvester.install.automatic=true harvester.install.config_url=http://10.100.0.10/harvester/config-join.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">initrd harvester-&lt;version&gt;-initrd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This assumes the iPXE script is stored in <code>/usr/share/nginx/html/harvester/ipxe-join</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dhcp-server-configuration">DHCP Server Configuration<a href="#dhcp-server-configuration" class="hash-link" aria-label="Direct link to DHCP Server Configuration" title="Direct link to DHCP Server Configuration">​</a></h2><p>The following is an example of how to configure the ISC DHCP server to offer iPXE scripts:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">option architecture-type code 93 = unsigned integer 16;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subnet 10.100.0.0 netmask 255.255.255.0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    option routers 10.100.0.10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        option domain-name-servers 192.168.2.1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    range 10.100.0.100 10.100.0.253;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # create group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if exists user-class and option user-class = &quot;iPXE&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # iPXE Boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if option architecture-type = 00:07 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      filename &quot;http://10.100.0.10/harvester/ipxe-create-efi&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      filename &quot;http://10.100.0.10/harvester/ipxe-create&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # PXE Boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if option architecture-type = 00:07 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # UEFI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      filename &quot;ipxe.efi&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # Non-UEFI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      filename &quot;undionly.kpxe&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  host node1 { hardware ethernet 52:54:00:6b:13:e2; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">group {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # join group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if exists user-class and option user-class = &quot;iPXE&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # iPXE Boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if option architecture-type = 00:07 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      filename &quot;http://10.100.0.10/harvester/ipxe-join-efi&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      filename &quot;http://10.100.0.10/harvester/ipxe-join&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # PXE Boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if option architecture-type = 00:07 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # UEFI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      filename &quot;ipxe.efi&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # Non-UEFI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      filename &quot;undionly.kpxe&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  host node2 { hardware ethernet 52:54:00:69:d5:92; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The config file declares a subnet and two groups. The first group is for hosts to boot using <code>CREATE</code> mode and the other one is for <code>JOIN</code> mode. By default, the iPXE path is chosen, but if it sees a PXE client it offers the iPXE image according to the client architecture. Please prepare those images and a TFTP server first.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="harvester-configuration">Harvester Configuration<a href="#harvester-configuration" class="hash-link" aria-label="Direct link to Harvester Configuration" title="Direct link to Harvester Configuration">​</a></h2><p>For more information about Harvester configuration, please refer to the <a href="/v1.0/install/harvester-configuration">Harvester configuration</a> page.</p><p>Users can also provide configuration via kernel parameters. For example, to specify the <code>CREATE</code> install mode, users can pass the <code>harvester.install.mode=create</code> kernel parameter when booting. Values passed through kernel parameters have higher priority than values specified in the config file.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="uefi-http-boot-support">UEFI HTTP Boot support<a href="#uefi-http-boot-support" class="hash-link" aria-label="Direct link to UEFI HTTP Boot support" title="Direct link to UEFI HTTP Boot support">​</a></h2><p>UEFI firmware supports loading a boot image from an HTTP server. This section demonstrates how to use UEFI HTTP boot to load the iPXE program and perform an automatic installation.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="serve-the-ipxe-program">Serve the iPXE Program<a href="#serve-the-ipxe-program" class="hash-link" aria-label="Direct link to Serve the iPXE Program" title="Direct link to Serve the iPXE Program">​</a></h3><p>Download the iPXE UEFI program from <a href="http://boot.ipxe.org/ipxe.efi" target="_blank" rel="noopener noreferrer">http://boot.ipxe.org/ipxe.efi</a> and make sure <code>ipxe.efi</code> can be downloaded from the HTTP server. For example:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> /usr/share/nginx/html/harvester/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> http://boot.ipxe.org/ipxe.efi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The file now can be downloaded from <a href="http://10.100.0.10/harvester/ipxe.efi" target="_blank" rel="noopener noreferrer">http://10.100.0.10/harvester/ipxe.efi</a> locally.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dhcp-server-configuration-1">DHCP Server Configuration<a href="#dhcp-server-configuration-1" class="hash-link" aria-label="Direct link to DHCP Server Configuration" title="Direct link to DHCP Server Configuration">​</a></h3><p>If the user plans to use the UEFI HTTP boot feature by getting a dynamic IP first, the DHCP server needs to provide the iPXE program URL when it sees such a request. The following is an updated ISC DHCP server group example:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">group {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # create group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if exists user-class and option user-class = &quot;iPXE&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # iPXE Boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if option architecture-type = 00:07 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      filename &quot;http://10.100.0.10/harvester/ipxe-create-efi&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      filename &quot;http://10.100.0.10/harvester/ipxe-create&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } elsif substring (option vendor-class-identifier, 0, 10) = &quot;HTTPClient&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # UEFI HTTP Boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    option vendor-class-identifier &quot;HTTPClient&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    filename &quot;http://10.100.0.10/harvester/ipxe.efi&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # PXE Boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if option architecture-type = 00:07 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # UEFI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      filename &quot;ipxe.efi&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # Non-UEFI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      filename &quot;undionly.kpxe&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  host node1 { hardware ethernet 52:54:00:6b:13:e2; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>elsif substring</code> statement is new, and it offers <code>http://10.100.0.10/harvester/ipxe.efi</code> when it sees a UEFI HTTP boot DHCP request. After the client fetches the iPXE program and runs it, the iPXE program will send a DHCP request again and load the iPXE script from the URL <code>http://10.100.0.10/harvester/ipxe-create-efi</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-ipxe-script-for-uefi-boot">The iPXE Script for UEFI Boot<a href="#the-ipxe-script-for-uefi-boot" class="hash-link" aria-label="Direct link to The iPXE Script for UEFI Boot" title="Direct link to The iPXE Script for UEFI Boot">​</a></h3><p>It&#x27;s mandatory to specify the initrd image for UEFI boot in the kernel parameters. The following is an updated version of iPXE script for <code>CREATE</code> mode.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!ipxe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kernel harvester-&lt;version&gt;-vmlinuz initrd=harvester-&lt;version&gt;-initrd ip=dhcp net.ifnames=1 rd.cos.disable rd.noverifyssl console=tty1 root=live:http://10.100.0.10/harvester/rootfs.squashfs harvester.install.automatic=true harvester.install.config_url=http://10.100.0.10/harvester/config-create.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">initrd harvester-&lt;version&gt;-initrd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The parameter <code>initrd=harvester-&lt;version&gt;-initrd</code> is required.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="useful-kernel-parameters">Useful Kernel Parameters<a href="#useful-kernel-parameters" class="hash-link" aria-label="Direct link to Useful Kernel Parameters" title="Direct link to Useful Kernel Parameters">​</a></h2><p>Besides the Harvester configuration, you can also specify other kernel parameters that are useful in different scenarios.
See also <a href="https://man7.org/linux/man-pages/man7/dracut.cmdline.7.html" target="_blank" rel="noopener noreferrer">dracut.cmdline(7)</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ipdhcp"><code>ip=dhcp</code><a href="#ipdhcp" class="hash-link" aria-label="Direct link to ipdhcp" title="Direct link to ipdhcp">​</a></h3><p>If you have multiple network interfaces, you could add the <code>ip=dhcp</code> parameter to get IP from the DHCP server from all interfaces.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rdnetdhcpretrycnt"><code>rd.net.dhcp.retry=&lt;cnt&gt;</code><a href="#rdnetdhcpretrycnt" class="hash-link" aria-label="Direct link to rdnetdhcpretrycnt" title="Direct link to rdnetdhcpretrycnt">​</a></h3><p>Failing to get IP from the DHCP server would cause iPXE booting to fail. You can add parameter <code>rd.net.dhcp.retry=&lt;cnt&gt;</code>
to retry DHCP request for <code>&lt;cnt&gt;</code> times.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/harvester/docs/edit/main/versioned_docs/version-v1.0/install/pxe-boot-install.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-11-25T02:18:22.000Z">Nov 25, 2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/v1.0/install/usb-install"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">USB Installation</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/v1.0/install/harvester-configuration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Harvester Configuration</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisite" class="table-of-contents__link toc-highlight">Prerequisite</a></li><li><a href="#preparing-http-servers" class="table-of-contents__link toc-highlight">Preparing HTTP Servers</a></li><li><a href="#preparing-boot-files" class="table-of-contents__link toc-highlight">Preparing Boot Files</a></li><li><a href="#preparing-ipxe-boot-scripts" class="table-of-contents__link toc-highlight">Preparing iPXE Boot Scripts</a><ul><li><a href="#create-mode" class="table-of-contents__link toc-highlight">CREATE Mode</a></li><li><a href="#join-mode" class="table-of-contents__link toc-highlight">JOIN Mode</a></li></ul></li><li><a href="#dhcp-server-configuration" class="table-of-contents__link toc-highlight">DHCP Server Configuration</a></li><li><a href="#harvester-configuration" class="table-of-contents__link toc-highlight">Harvester Configuration</a></li><li><a href="#uefi-http-boot-support" class="table-of-contents__link toc-highlight">UEFI HTTP Boot support</a><ul><li><a href="#serve-the-ipxe-program" class="table-of-contents__link toc-highlight">Serve the iPXE Program</a></li><li><a href="#dhcp-server-configuration-1" class="table-of-contents__link toc-highlight">DHCP Server Configuration</a></li><li><a href="#the-ipxe-script-for-uefi-boot" class="table-of-contents__link toc-highlight">The iPXE Script for UEFI Boot</a></li></ul></li><li><a href="#useful-kernel-parameters" class="table-of-contents__link toc-highlight">Useful Kernel Parameters</a><ul><li><a href="#ipdhcp" class="table-of-contents__link toc-highlight"><code>ip=dhcp</code></a></li><li><a href="#rdnetdhcpretrycnt" class="table-of-contents__link toc-highlight"><code>rd.net.dhcp.retry=&lt;cnt&gt;</code></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 harvesterhci.io</div></div></div></footer></div>
<script src="/assets/js/runtime~main.693e3b15.js"></script>
<script src="/assets/js/main.d1ef793e.js"></script>
</body>
</html>